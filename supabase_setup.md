# Configuración Inicial de Supabase para AhorrApp

Para conectar la aplicación con la nube, sigue estos pasos:

## 1. Crear Proyecto en Supabase
1.  Ve a [supabase.com](https://supabase.com) y regístrate/inicia sesión.
2.  Haz clic en **"New Project"**.
3.  Nombre: `AhorrApp` (o lo que prefieras).
4.  Base de datos Password: Genera uno seguro y guárdalo (no lo usaremos en la app, pero es vital para admin).
5.  Región: Selecciona la más cercana (ej. Frankfurt o London para Europa).
6.  Espera unos minutos a que se despliegue.

## 2. Obtener Credenciales
1.  En el dashboard de tu proyecto, ve a **Settings** (icono engranaje abajo a la izquierda) -> **API**.
2.  Copia la **Project URL**.
3.  Copia la **anon public key**.
4.  Mantén esta pestaña abierta, las necesitaremos para configurar la app en el siguiente paso.

## 3. Crear Tablas (Base de Datos)
Ve al **SQL Editor** (barra lateral izquierda) -> **New Query**, pega el siguiente código y dale a **Run**:

```sql
-- 1. Tabla de PRECIOS (La principal)
create table public.prices (
  id bigint generated by default as identity primary key,
  barcode text not null,
  product_name text,
  brand text,
  supermarket text not null,
  price numeric not null,
  more_info text,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  user_id uuid default auth.uid() -- Se vincula automáticamente si el usuario está logueado
);

-- 2. Habilitar seguridad (Row Level Security)
alter table public.prices enable row level security;

-- 3. Políticas de acceso (Permitir todo por ahora para testear, luego restringiremos)
-- Permitir lectura pública
create policy "Public prices are viewable by everyone"
  on public.prices for select
  using ( true );

-- Permitir inserción a cualquiera (anónimo o logueado)
create policy "Anyone can insert prices"
  on public.prices for insert
  with check ( true );
  
-- Opcional: Permitir update solo de tus propios precios (si guardamos user_id)
create policy "Users can update own prices"
  on prices for update
  using ( auth.uid() = user_id );
```

## 4. Siguiente Paso
Una vez tengas esto, vuelve al chat y proporcióname la **URL** y la **ANON KEY** (o configúralas tú mismo si prefieres no compartirlas) para que pueda conectar el código de `Repository.kt` con tu nube real.
